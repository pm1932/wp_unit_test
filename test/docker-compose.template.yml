version: '2'
services:
  web:
    build:
      context: ./phpunit/
    ports:
      - %HOST_PORT%:80
    volumes:
      - %WP_ROOT%:/var/www/html:cached
      - ./phpunit/php.ini:/usr/local/etc/php/php.ini:cached
    links:
      - db:mysql
    environment:
      HOST_PORT: %HOST_PORT%
      HOST_NAME: %HOST_NAME%
      XDEBUG_CONFIG: remote_host=%MY_IP%
      PHP_IDE_CONFIG: "serverName=my.local"

  db:
    build:
      context: ./mysql/
    ports:
      - %DB_HOST_PORT%:3306
    volumes:
      - ./mysql/my.cnf:/etc/mysql/conf.d/my.cnf:cached
      - ./mysql/init.d:/docker-entrypoint-initdb.d:cached
    environment:
      MYSQL_ROOT_PASSWORD: pman7170
      MYSQL_DATABASE: wp_db
